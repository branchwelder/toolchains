import{y as d,b as $}from"./index-c839d3ed.js";function x(l,o,e){let r=Math.sqrt(o*o+e*e),n=Math.floor(r/l*1e3),c=Math.floor(o*40),i=Math.floor(e*40);return`XM,${n},${c},${i}\r`}const S={nickname:"QT\r",reboot:"RB\r",queryPenUp:"QP\r",togglePen:"TP\r",home:"HM,1000\r",disableMotors:"EM,0,0\r",enableMotors:"EM,1,1\r",segment:x(5,10,10),eStop:"ES\r"},C={inports:{},outports:{serialOut:{type:"string",value:null}},state:{connected:!1,currentCommand:S.nickname},ui:{displayName:"Axi",width:"200px",height:"200px"}};function P(l,o,e){function s(){}let r,n,c,i,a;async function p(){const t=new TextDecoderStream;for(c=a.readable.pipeTo(t.writable),n=t.readable.getReader();;){const{value:u,done:y}=await n.read();if(y){n.releaseLock();break}console.log(`AXI says ${u}`),o.serialOut.value=u}}async function m(){const t=new TextEncoderStream;i=t.readable.pipeTo(a.writable),r=t.writable.getWriter()}async function f(t){await r.write(t)}async function w(){await a.open({baudRate:9600}),e.connected=!0,p(),m()}async function b(){n.cancel(),await c.catch(()=>{}),r.close(),await i,await a.close(),e.connected=!1}async function M(){e.connected?(console.log("Disconnect"),b()):navigator.serial.requestPort().then(t=>{a=t,w()}).catch(t=>{console.log("oops no port selected")})}function g(){return d`<input type="text" value=${e.currentCommand} />
      <button @click=${()=>f(e.currentCommand)}>send</button>`}function h(){return d`
      <button @click=${M}>
        ${e.connected?"Disconnect":"Connect"}
      </button>
      ${e.connected?g():$}
    `}return{init:s,render:h}}const T={config:C,tool:P};export{T as default};
